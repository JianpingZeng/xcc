/*
 * Extremely C language Compiler
 * Copyright (c) 2015-2018, Jianping Zeng.
 *
 * Licensed under the BSD License version 3. Please refer LICENSE
 * for details.
 */

package backend.target.x86;

import backend.support.BackendCmdOptions;
import backend.support.Triple;
import backend.mc.MCAsmInfoDarwin;

/**
 * @author Jianping Zeng
 * @version 0.4
 */
public class X86MCAsmInfoDarwin extends MCAsmInfoDarwin {
  public X86MCAsmInfoDarwin(Triple triple) {
    super();
    AsmTransCBE = X86.x86_asm_table;
    AssemblerDialect = BackendCmdOptions.AsmWriterFlavor.value;
    boolean is64Bit = triple.getArch() == Triple.ArchType.x86_64;

    TextAlignFillValue = 0x90;

    if (!is64Bit)
      Data64bitsDirective = null;       // we can't emit a 64-bit unit

    // Use ## as a comment string so that .s files generated by llvm can go
    // through the GCC preprocessor without causing an error.  This is needed
    // because "clang foo.s" runs the C preprocessor, which is usually reserved
    // for .S files on other systems.  Perhaps this is because the file system
    // wasn't always case preserving or something.
    CommentString = "##";
    PCSymbol = ".";

    SupportsDebugInformation = true;
    DwarfUsesInlineInfoSection = true;

    // Exceptions handling
    ExceptionsType = ExceptionHandlingType.Dwarf;
    AbsoluteEHSectionOffsets = false;
  }
}
